Steps to Successfully Run OpenUxAS GTests on Windows
===========================================

Installing and Setting Up Google Test Adapter
---------------------------------------------

A work around is required because Visual Studio cannot detect the Unit Tests and the paths set in the tests are not configured properly for the Windows

**To Configure the Google Test Adapter:**

1. Install the Google Test Adapter extension for Visual Studio. This extension is compatible with Visual Studio 2012, 2013, 2015, and 2017. Click  [here](https://marketplace.visualstudio.com/items?itemName=ChristianSoltenborn.GoogleTestAdapter) to reach the download page.

1. Make sure the Google Test Adapter extension is enabled.
  * Open Visual Studio
  * In the Visual Studio menu bar, click the Tools menu item.
  * Now click the Extensions and Updates button. The Extensions and Updates pop up window should appear.
  * In the extensions and updates pop up window, make sure the Google Test Adapter is enabled. This should be located in your installed tools.
  * If the Google Test Adapter was not enabled, close and reopen the OpenUxAS Visual Studio solution.

1. Now open the Test Explorer in Visual Studio. If the test explorer is not visible, click Tests -> Windows -> Test Explorer

You should now be able to run the GTests from the Test Explorer.

Setting Up GTest Paths for Windows Compatibility
------------------------------------------------

Currently the GTest configurations assume that the test executable's path is only 1 level deep from the OpenUxAS directory. When using the Google Test Adapter extension, the executable is in the same directory as the test's respective cpp file.

**To successfully run a GTest:**

1. Open each test's .cpp file. Change the testPath variable to have it point to the messages folder, ensuring that the search starts from the OpenUxAS root directory. NOTE: The messages configuration file is located somewhere within the tests folder in the OpenUxAS directory, not in the tests folder generated by the meson build.

1. The path in the messages configuration file also needs to be changed. To maintain compatibility with the Linux and Mac OS builds, duplicate the messages configuration file for the test and rename it to be standard with the other Windows test configurations.

1.  In the copied configuration file locate the SendMessagesService node. In this node, change the PathToMessageFiles field to go back as many directories as the testPath variable in the tests cpp file.

An example snippet that can be used in the test's cpp file that maintains compatibility with the Windows, Mac OS, and Linux builds can be seen below:


```cpp

std::string testPath; //the path of the UxAS configuration file
std::string configFileName; //name of the configuration file

	#ifdef _WIN32 //check if running in windows
		testPath = "../../../../../tests/Test_Services/00_ExampleTests/03_Test_Example_DistributedCooperation/";
		configFileName = "cfg_DistributedCooperation_Windows.xml";
	#endif
	#ifndef _WIN32 //if not the windows build look back 1 directory and use correct config
		testPath = "../tests/Test_Services/00_ExampleTests/03_Test_Example_DistributedCooperation/";
		configFileName = "cfg_DistributedCooperation.xml";
	#endif // !_WIN32

  std::string uxasConfigurationFile = testPath + configFileName; // the relative path to the UxAS configuration file
```
This snippet is currently used in the DistributedCooperation_test01.CorrectNumberMessages test.
